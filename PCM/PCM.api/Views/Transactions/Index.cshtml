@model List<_999_Transaction>

@{
    ViewData["Title"] = "Qu·∫£n L√Ω Giao D·ªãch T√†i Ch√≠nh";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Giao D·ªãch T√†i Ch√≠nh</h2>
        <a href="@Url.Action("Create")" class="btn btn-primary">+ Th√™m Giao D·ªãch</a>
    </div>

    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    @{
                        var totalIncome = Model.Where(t => t.Type == "Income").Sum(t => t.Amount);
                    }
                    <h6 class="card-title text-muted">T·ªïng Thu Nh·∫≠p</h6>
                    <h3 class="text-success">@totalIncome.ToString("C0")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    @{
                        var totalExpense = Model.Where(t => t.Type == "Expense").Sum(t => t.Amount);
                    }
                    <h6 class="card-title text-muted">T·ªïng Chi Ph√≠</h6>
                    <h3 class="text-danger">@totalExpense.ToString("C0")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    @{
                        var balance = totalIncome - totalExpense;
                    }
                    <h6 class="card-title text-muted">C√¢n ƒê·ªëi</h6>
                    <h3 class="@(balance >= 0 ? "text-success" : "text-danger")">@balance.ToString("C0")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <h6 class="card-title text-muted">T·ªïng Giao D·ªãch</h6>
                    <h3>@Model.Count()</h3>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h6 class="mb-0">L·ªãch S·ª≠ Giao D·ªãch</h6>
        </div>
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Ng√†y</th>
                        <th>Th√†nh Vi√™n</th>
                        <th>Lo·∫°i</th>
                        <th>Danh M·ª•c</th>
                        <th>S·ªë Ti·ªÅn</th>
                        <th>M√¥ T·∫£</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.Any())
                    {
                        @foreach (var transaction in Model)
                        {
                            <tr>
                                <td>@transaction.TransactionDate.ToString("dd/MM/yyyy HH:mm")</td>
                                <td>
                                    @if (transaction.Member != null)
                                    {
                                        <strong>@transaction.Member.FullName</strong>
                                    }
                                    else
                                    {
                                        <em class="text-muted">Ch∆∞a x√°c ƒë·ªãnh</em>
                                    }
                                </td>
                                <td>
                                    <span class="badge bg-@(transaction.Type == "Income" ? "success" : "danger")">
                                        @transaction.Type
                                    </span>
                                </td>
                                <td>@transaction.Category</td>
                                <td class="@(transaction.Type == "Income" ? "text-success" : "text-danger") fw-bold">
                                    @(transaction.Type == "Income" ? "+" : "-")@transaction.Amount.ToString("C0")
                                </td>
                                <td>@transaction.Description</td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6" class="text-center text-muted py-4">Ch∆∞a c√≥ giao d·ªãch n√†o</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <div class="mt-4">
        <a href="@Url.Action("Report")" class="btn btn-info">üìä Xem B√°o C√°o Chi Ti·∫øt</a>
    </div>
</div>
